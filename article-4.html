<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Chromatic Journey | Modern Magazine</title>
</head>
<body>
    <div class="article-page article-dynamic" data-dynamic-theme=".hero-image img">
        <m-nav>
          <a href="index.html" class="logo">MAGAZINE</a>
          <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="blog.html">Blog</a>
            <a href="about.html">About</a>
            <a href="elements.html">Elements</a>
          </div>
        </m-nav>

        <!-- Article Hero - Dynamic Color -->
        <header class="article-hero dynamic-hero">
          <div class="hero-image">
            <img src="/images/image4.png" alt="The Chromatic Journey" crossorigin="anonymous" id="hero-img">
          </div>
          <div class="hero-overlay dynamic-overlay">
            <m-reveal class="fly-in-up">
              <div class="article-meta">
                <span class="category dynamic-accent">IMMERSIVE</span>
                <span class="read-time">20 MIN READ</span>
              </div>
              <h1 class="article-title dynamic-title title-chromatic">The Chromatic<br>Journey</h1>
              <p class="article-subtitle">A multi-sensory exploration through dynamic environmental color</p>
            </m-reveal>
          </div>
          <m-chevron text="Start Journey"></m-chevron>
        </header>

        <!-- Centered Article Layout -->
        <article class="article-centered-dense">
          
          <!-- Main Column -->
          <div class="main-column">
            
            <!-- Lead -->
            <section class="article-lead">
              <m-reveal class="fly-in-up">
                <p class="lead-text">
                  <span class="drop-cap dynamic-drop">W</span>elcome to an experiment in 
                  reactive storytelling. As you journey through this article, observe how 
                  the digital environment shifts to match the visual narrative.
                </p>
              </m-reveal>
            </section>

            <!-- Section 1 (Hero follows automatically) -->
            <section class="article-body text-columns">
              <m-reveal class="fly-in-up">
                <h2 class="dynamic-heading">Phase One: Departure</h2>
                <p>
                  Every journey begins with a single step into the unknown. We leave behind 
                  the familiar comfort of monochrome and venture into the vibrant spectrum. 
                  Just as the world changes when you travel, so too should our digital 
                  surroundings adapt to reflect where we are.
                </p>
                <p>
                  The transition is not merely cosmetic; it is a fundamental shift in perception.
                  When color envelops us, it changes how we process information, how we feel time passing,
                  and how we connect with the story being told. It is an immersion into a living canvas.
                </p>
              </m-reveal>
            </section>

            <!-- Section 2: Image 5 -->
            <figure class="article-image full-bleed dynamic-section" data-image-source="image5-el">
              <m-reveal class="fly-in-up">
                <img src="/images/image5.png" alt="Abstract Blue Structure" crossorigin="anonymous" id="image5-el">
                <figcaption>Phase Two: The Cool Depths</figcaption>
              </m-reveal>
            </figure>

            <section class="article-body text-columns">
              <m-reveal class="fly-in-up">
                <h2 class="dynamic-heading">Phase Two: Immersion</h2>
                <p>
                  We descend into cooler tones. The frenetic energy of the surface fades, 
                  replaced by the structured calm of blue harmonics. Here, information
                  becomes clearer, distractions dissolve. The environment responds to the
                  visual calmness of the imagery.
                </p>
                <p>
                  Notice how the accents—the links, the headers, the drop caps—simultaneously
                  shift. This isn't just a background change; it's a re-orchestration of
                  the entire design system based on the dominant frequencies of the current view.
                </p>
              </m-reveal>
            </section>

             <!-- Section 3: Image 6 -->
             <figure class="article-image full-bleed dynamic-section" data-image-source="image6-el">
              <m-reveal class="fly-in-up">
                <img src="/images/image6.png" alt="Fiery Architecture" crossorigin="anonymous" id="image6-el">
                <figcaption>Phase Three: The Radiant Peak</figcaption>
              </m-reveal>
            </figure>

            <section class="article-body text-columns">
              <m-reveal class="fly-in-up">
                <h2 class="dynamic-heading">Phase Three: Radiance</h2>
                <p>
                  We emerge into the light. Warmths radiates from the architecture of the
                  image, influencing the very page you read. The text remains legible
                  thanks to algorithmic contrast enforcement, but the mood is now entirely
                  different: energetic, bold, optimistic.
                </p>
                <p>
                   Dynamic theming allows us to break free from the "uniform website."
                   Why should an article about fire look the same as an article about ice?
                   Here, content dictates form.
                </p>
                <p class="article-end">◆</p>
              </m-reveal>
            </section>

          </div>

        </article>

        <!-- Related Articles -->
        <section class="related-articles">
          <m-reveal class="fly-in-up">
            <h2 class="section-title">More Journeys</h2>
          </m-reveal>
          <div class="related-grid">
            <m-reveal class="fly-in-left">
              <a href="article-3.html" class="related-card">
                <img src="/images/image2.png" alt="Color Tech">
                <div class="related-content">
                  <span class="related-category">DEEP DIVE</span>
                  <h3>The Color of Innovation</h3>
                  <span class="related-time">15 min read</span>
                </div>
              </a>
            </m-reveal>
            <m-reveal class="fly-in-right">
              <a href="article-1.html" class="related-card">
                <img src="/images/image1.png" alt="Future Design">
                <div class="related-content">
                  <span class="related-category">EDITORIAL</span>
                  <h3>The Future of Design</h3>
                  <span class="related-time">8 min read</span>
                </div>
              </a>
            </m-reveal>
          </div>
        </section>

        <footer class="site-footer">
          <div class="footer-content">
            <div class="copyright">
              &copy; 2026 MODERN MAGAZINE. ALL RIGHTS RESERVED.
            </div>
          </div>
        </footer>
    </div>

    <script type="module" src="/src/main.js"></script>
    <script type="module">
      import { DynamicTheme } from '/src/js/color-thief.js';
      
      document.addEventListener('DOMContentLoaded', async () => {
        const article = document.querySelector('.article-dynamic');
        
        // --- 1. Initial Hero Theme (Image 4) ---
        const heroImg = document.querySelector('#hero-img');
        if (heroImg && article) {
          if (!heroImg.complete) {
            await new Promise(resolve => heroImg.onload = resolve);
          }
          await window.dynamicTheme.applyFromImage(heroImg, article);
          console.log('Phase 1 Theme Applied');
        }

        // --- 2. Scroll-Based Theming (Images 5 & 6) ---
        // We'll observe the "Sections" containing the images. 
        // When they cross a threshold, we apply their colors.
        
        const observerOptions = {
          root: null,
          threshold: 0.5, // Trigger when 50% of the image is visible
          rootMargin: "-10% 0px -10% 0px"
        };

        const themeObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const imgId = entry.target.dataset.imageSource;
              const img = document.getElementById(imgId);
              
              if (img && img.complete) {
                 // Transition: Smoothly update CSS variables
                 // JS updates are instant, CSS 'transition' on the elements handles the smoothing
                 window.dynamicTheme.applyFromImage(img, article);
                 console.log(`Switched theme to ${imgId}`);
              }
            }
          });
        }, observerOptions);

        // Observe the dynamic sections (containing the images)
        document.querySelectorAll('.dynamic-section').forEach(section => {
          themeObserver.observe(section);
        });

        // Also observe the hero again to revert when scrolling back up
        const heroObserver = new IntersectionObserver((entries) => {
             entries.forEach(async entry => {
               // If hero is heavily visible again, revert
               if (entry.isIntersecting) {
                   await window.dynamicTheme.applyFromImage(heroImg, article);
                   console.log('Reverted to Phase 1 Theme');
               }
             });
        }, { threshold: 0.5 });
        
        const heroSection = document.querySelector('.article-hero');
        if(heroSection) heroObserver.observe(heroSection);

      });
    </script>
</body>
</html>
